
mccy:
  image: ${COMPOSE_PROJECT_NAME}_mccy
  volumes:
    - mccy:/data
  environment:
    - "constraint:node==$PINNED_NODE"
  command: >
    --security.user.password=$MCCY_PASSWORD 
    --mccy.docker-host-uri=$TARGET_DOCKER_URI
    --mccy.docker-cert-path=/certs 
    --mccy.deployment-powered-by.image-src=img/powered-by/powered-by-carina-wide.png
    --mccy.deployment-powered-by.href=https://getcarina.com/ 
    --spring.active-profiles=docker

proxy:
  image: smashwilson/lets-nginx
  links:
    - mccy
  ports:
    - "80:80"
    - "443:443"
  environment:
    - "constraint:node==$PINNED_NODE"
    - "UPSTREAM=mccy:8080"
    - "EMAIL=$LETSENCRYPT_EMAIL"
    - "DOMAIN=$LETSENCRYPT_DOMAIN"
  volumes:
    - dhparam-cache:/cache
    - letsencrypt:/etc/letsencrypt
    - letsencrypt-backups:/var/lib/letsencrypt
